# Bootstrap definition example neuronunit

%setup
    echo "Looking in directory '$SINGULARITY_ROOTFS' for /bin/sh"
    if [ ! -x "$SINGULARITY_ROOTFS/bin/sh" ]; then
        echo "Hrmm, this container does not have /bin/sh installed..."
        exit 1
    fi
    exit 0

%post
    if [ ! -d "/home/jovyan/git" ]; then
       	 mkdir git; cd git
       	 git clone -b dev https://github.com/russelljjarvis/neuronunit.git
	 cd neuronunit
	 /opt/conda/bin/python setup.py install
	 git clone -b dev https://github.com/scidash/sciunit.git
	 cd sciunit
	 /opt/conda/bin/python setup.py install; #This semi colon is necessary for closing the BASH conditional.
	 fi
    exec /bin/bash
    su jovyan
    cd /home/jovyan/neuronunit/neuronunit/tests
    exit 0	

#only one of the bottom two commands should be sufficient. Need further experimentation to work out which one.
#for now both work.

%runscript
    /opt/conda/bin/python -m scoop nsga.py 
    
%test
    /opt/conda/bin/python -m scoop nsga.py 

