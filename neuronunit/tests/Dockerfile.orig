#author Russell Jarvis rjjarvis@asu.edu
#author Rick Gerkin rgerkin@asu.edu
FROM scidash/neuronunit
USER root

RUN pip install --upgrade pip
RUN pip install matplotlib
RUN easy_install gevent
RUN easy_install greenlet
<<<<<<< HEAD
ENV ATOM_VERSION v1.12.7

RUN apt-get install -y gedit meld gvfs-bin

RUN apt-get install -y build-essential
RUN apt-get update


#Create python bindings for NEURON
=======
RUN apt-get update
RUN apt-get install -y gvfs-bin
RUN apt-get update

>>>>>>> dev2


ENV WORK_HOME $HOME/work/scidash
RUN ipython profile create default
RUN apt-get install -y libxss1
RUN git clone https://github.com/soravux/scoop
WORKDIR scoop
RUN python setup.py install
RUN apt-get install -y python3-setuptools
ENV PATH $PATH:/opt/conda/bin
RUN easy_install gevent
RUN easy_install greenlet
#RUN apt-get install -y povray eog
WORKDIR $HOME
RUN git clone https://github.com/russelljjarvis/BluePyOpt.git
WORKDIR BluePyOpt
RUN python setup.py install
RUN apt-get install -y python-tk
RUN chown -R jovyan $HOME
RUN python -c "import bluepyopt"
RUN conda install mpi4py
RUN pip install git+https://github.com/roryk/ipython-cluster-helper

RUN ipcluster nbextension enable
RUN apt-get install -y curl apt-utils
RUN apt-get update

<<<<<<< HEAD
=======

>>>>>>> dev2
WORKDIR $HOME

RUN chown -R jovyan /opt/conda/lib/python3.5/site-packages/

USER $NB_USER


ENV PATH $PATH:/opt/conda/bin
ENV PATH $PATH:/opt/conda/bin/ipcluster
ENV PATH $PATH:/opt/conda/bin/ipython
ENV PATH $PATH:/opt/conda/bin/pip
ENV PATH $PATH:/opt/conda/bin/python
ENV PATH $PATH:/opt/conda/lib/python3.5/site-packages
ENV PATH $PATH:$PYTHONPATH

RUN sudo /opt/conda/bin/pip install \
	IPython \
	jupyterhub \
	notebook \
	ipykernel \
	ipyparallel \
	enum34


RUN sudo printenv PATH
RUN python -c "import pyneuroml"
RUN python -c "import neuronunit"
RUN python -c "from neuronunit.models.reduced import ReducedModel"
RUN python -c "import quantities"
RUN python -c "import neuron"
RUN python -c "import pyneuroml"
RUN nrnivmodl
RUN python -c "import scoop"

RUN python -c "import deap"

RUN sudo apt-get install -y ssh

RUN sudo apt-get install -y libglib2.0-0 libxext6 libsm6 libxrender1 \
    gcc g++ build-essential \
    libglib2.0-0 libxext6 libsm6 libxrender1 \
libncurses-dev openmpi-bin openmpi-doc libopenmpi-dev
RUN sudo apt-get -y remove python2.7


# Get python bindings for open mpi
WORKDIR $HOME
RUN sudo /opt/conda/bin/conda install -y mpi4py


RUN nrniv
WORKDIR $HOME/nrn-7.4
RUN rm -r /home/jovyan/nrn-7.4/x86_64/

<<<<<<< HEAD
RUN sudo ./configure --prefix=`pwd` --without-iv --with-paranrn=/usr/bin/mpiexec --with-nrnpython=/opt/conda/bin/python
RUN sudo make all && \
   sudo make install

WORKDIR src/nrnpython
RUN sudo /opt/conda/bin/python setup.py install
ENV PATH $HOME/neuron/nrn-7.4/x86_64/bin:$PATH
#ENV PYTHONHOME /opt/conda/bin/python
=======
>>>>>>> dev2
RUN export PATH=$PATH

#un comment the following line to test ipcluster during build.
#RUN ipcluster start --profile=chase --debug &
#https://github.com/russelljjarvis/neuronunit.git
WORKDIR $HOME


RUN git clone -b dev https://github.com/russelljjarvis/neuronunit.git
WORKDIR $HOME/neuronunit/neuronunit/tests/NeuroML2

RUN nrnivmodl
RUN ls LEMS_2007One.xml
WORKDIR $HOME/neuronunit/neuronunit/tests/
RUN ls *.pickle
<<<<<<< HEAD


#ENTRYPOINT python -m scoop nsga.py
#ENTRYPOINT python -m scoop exhaustive_search.py
=======
RUN which python3


ENTRYPOINT python -m scoop exhaustive_search.py
>>>>>>> dev2
